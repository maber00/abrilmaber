---
import { Image } from 'astro:assets';

// Importa las imágenes necesarias para los previews
import videoImage from '../assets/anima2.jpg';
import comercialesImage from '../assets/anima1.jpg';

// Videos de YouTube para cada servicio (reemplaza con tus propios IDs de videos)
const iaVideos = [
  {
    id: 1,
    thumbnail: videoImage,
    title: "Generación de Video con IA",
    tags: ["IA", "Producción"],
    videoUrl: "https://youtu.be/SfjkEfBlDZk" // Reemplaza con tu video real de IA
  },
  {
    id: 2,
    thumbnail: comercialesImage,
    title: "Avatares Hiperrealistas",
    tags: ["IA", "Avatares"],
    videoUrl: "https://youtu.be/K1RnQxg47a4" // Reemplaza con tu video real de avatares
  }
];
---

<section class="py-20 bg-black text-white">
  <div class="container mx-auto px-4">
    <!-- Título principal y descripción -->
    <div class="text-center mb-16">
      <span class="text-xs uppercase tracking-wider text-gray-400">RENDER</span>
      <h2 class="text-5xl md:text-7xl lg:text-[80px] font-serif font-normal mb-6 mt-3">
        Potenciamos historias<br>
        con inteligencia artificial.
      </h2>
      <div class="w-full md:w-800 h-0.5 mb-8 mx-auto"></div>
      <p class="text-lg sm:text-xl max-w-3xl mx-auto opacity-80 font-roboto">
        Transformamos la comunicación audiovisual con tecnología de IA, 
        creando contenidos que conectan con audiencias e impulsan marcas.
      </p>
    </div>
    
    <!-- Grid de Videos de IA -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 md:gap-6 px-0 md:px-[50px] lg:px-[100px] mb-16">
      {iaVideos.map(video => (
        <div 
          class="project-item relative md:h-[250px] h-[150px] cursor-pointer"
          data-video-url={video.videoUrl}
          data-title={video.title}
          data-category={video.tags.join(',')}
        >
          <Image 
            src={video.thumbnail}
            alt={video.title}
            class="w-full h-full object-cover rounded-lg"
            width={500}
            height={500}
          />
          <div class="absolute inset-0 bg-black opacity-40 rounded-lg">
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="flex flex-col items-center">
                <div class="w-16 h-16 rounded-full bg-green-500/80 flex items-center justify-center mb-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <span class="text-white text-lg font-medium">Ver Demo</span>
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>
    
    <!-- Descripción detallada de los servicios -->
    <div class="max-w-5xl mx-auto  mb-16 text-center">
      <h3 class="text-2xl md:text-3xl font-normal mb-6">Nuestros Servicios de IA</h3>
      <p class="text-lg leading-relaxed font-roboto mb-8">
        En RENDER, utilizamos lo último en tecnología de inteligencia artificial para crear contenidos audiovisuales 
        que transforman la manera en que las marcas se comunican. Desde la generación de escenas completamente virtuales 
        hasta la creación de avatares hiperrealistas y animaciones personalizadas, nuestros servicios 
        representan el futuro de la producción audiovisual.
      </p>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-left mt-12">
        <!-- Servicio 1 -->
        <div class="p-6 bg-gray-900/50 rounded-lg">
          <h3 class="text-xl font-bold mb-3 text-green-500">Generación de Video IA</h4>
          <p class="text-gray-300 font-roboto">
            Creamos escenas, efectos visuales y ambientes completamente generados por IA, 
            reduciendo costos de producción y expandiendo las posibilidades creativas sin limitaciones físicas.
          </p>
        </div>
        
        <!-- Servicio 2 -->
        <div class="p-6 bg-gray-900/50 rounded-lg">
          <h3 class="text-xl font-roboto-400 font-normal mb-3 text-green-500">Avatares Hiperrealistas</h4>
          <p class="text-gray-300 font-roboto">
            Presentadores virtuales indistinguibles de humanos reales para tus contenidos corporativos, 
            educativos o comerciales, disponibles 24/7 y en múltiples idiomas.
          </p>
        </div>
        
        <!-- Servicio 3 -->
        <div class="p-6 bg-gray-900/50 rounded-lg">
          <h3 class="text-xl font-bold mb-3 text-green-500">Animación Creativa</h4>
          <p class="text-gray-300 font-roboto">
            Animaciones personalizadas con estilos y efectos únicos potenciados por IA que harán que 
            tu marca destaque con una estética inconfundible y moderna.
          </p>
        </div>
      </div>
    </div>
    
    <!-- CTA Final -->
    <div class="text-center mt-12">
      <a 
        href="/servicios-ia" 
        class="inline-block px-8 py-3 border-2 border-white rounded-full text-green-500 font-roboto"
      >
        Descubrir Todos Los Servicios IA
      </a>
    </div>
  </div>
  
  <!-- Modal para videos (similar al de portfolio.astro) -->
  <div id="iaVideoModal" class="modal fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/90">
      <div class="flex flex-col h-full items-center justify-center p-4 md:p-8 lg:p-[100px] gap-4 lg:gap-8 overflow-y-auto">
        <!-- Contenedor de Video -->
        <div class="w-full lg:w-2/3 aspect-video bg-black relative">
          <div id="videoContainer" class="relative w-full h-full">
            <!-- El iframe de YouTube se insertará aquí dinámicamente -->
          </div>
        </div>
        
        <!-- Info del Video -->
        <div class="w-full lg:w-1/3 text-white">
          <h2 class="text-2xl md:text-3xl font-bold mb-4" id="modalTitle"></h2>
          <div class="flex flex-wrap gap-2 mb-4">
            <span class="px-3 py-1 bg-green-500 rounded-full text-sm" id="modalTags"></span>
          </div>
        </div>

        <button id="closeIaModalBtn" class="absolute top-4 right-4 md:top-8 md:right-8 text-white text-4xl">&times;</button>
      </div>
    </div>
  </div>
</section>

<style>
  /* Fuentes */
  .font-serif {
    font-family: 'Noto Serif', serif;
  }
  
  .font-roboto {
    font-family: 'Roboto', sans-serif;
    font-weight: 400;
  }
  
  /* Modal estilo simple sin animaciones */
  .modal.hidden {
    display: none;
  }
</style>

<script>
  // Función para obtener el ID de YouTube
  function getYouTubeVideoId(url) {
    const regex = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
    const match = url.match(regex);
    return (match && match[2].length === 11) ? match[2] : null;
  }
  
  document.addEventListener('DOMContentLoaded', () => {
    // Funcionalidad del modal de video
    const modal = document.getElementById('iaVideoModal');
    const closeBtn = document.getElementById('closeIaModalBtn');
    const videoContainer = document.getElementById('videoContainer');
    const modalTitle = document.getElementById('modalTitle');
    const modalTags = document.getElementById('modalTags');
    const videoItems = document.querySelectorAll('.project-item');
    
    if (modal && closeBtn && videoContainer) {
      // Abrir modal al hacer clic en un video
      videoItems.forEach(item => {
        item.addEventListener('click', () => {
          const videoUrl = item.getAttribute('data-video-url');
          const title = item.getAttribute('data-title');
          const categories = item.getAttribute('data-category');
          
          if (videoUrl) {
            const videoId = getYouTubeVideoId(videoUrl);
            if (videoId) {
              videoContainer.innerHTML = `
                <iframe 
                  class="w-full h-full" 
                  src="https://www.youtube.com/embed/${videoId}" 
                  frameborder="0" 
                  allowfullscreen
                ></iframe>
              `;
              
              if (modalTitle) modalTitle.textContent = title;
              if (modalTags) modalTags.textContent = categories;
              
              modal.classList.remove('hidden');
              document.body.style.overflow = 'hidden';
            }
          }
        });
      });
      
      // Cerrar modal
      const closeModal = () => {
        modal.classList.add('hidden');
        document.body.style.overflow = '';
        videoContainer.innerHTML = '';
      };
      
      closeBtn.addEventListener('click', closeModal);
      
      // Cerrar al hacer clic fuera del contenido o con Escape
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });
      
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });
    }
  });
</script>